<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Presidio Browser Anonymizer - Dashboard</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="icon" type="image/svg+xml" href="logo.svg">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", Roboto, sans-serif;
      background: #f3f4f6;
      min-height: 100vh;
      display: flex;
    }

    /* Sidebar - Dark theme like React version */
    .sidebar {
      width: 256px;
      background: #1f2937;
      color: white;
      display: flex;
      flex-direction: column;
      padding: 16px;
      position: fixed;
      height: 100vh;
      left: 0;
      top: 0;
    }

    .logo-container {
      display: flex;
      align-items: center;
      margin-bottom: 24px;
      padding: 0 8px;
    }

    .logo-icon {
      width: 40px;
      height: 40px;
      margin-right: 12px;
    }

    .logo-text h1 {
      font-size: 20px;
      font-weight: 700;
      color: white;
      margin: 0;
    }

    .logo-text p {
      font-size: 12px;
      color: #9ca3af;
      margin: 0;
    }

    /* Language Switcher */
    .lang-switcher {
      display: flex;
      gap: 16px;
      padding: 0 8px;
      margin-bottom: 24px;
    }

    .lang-flag {
      width: 32px;
      height: 20px;
      border-radius: 2px;
      cursor: pointer;
      opacity: 0.5;
      transition: all 0.2s;
      transform: scale(1);
    }

    .lang-flag:hover {
      opacity: 1;
      transform: scale(1.1);
    }

    .lang-flag.active {
      opacity: 1;
      box-shadow: 0 0 0 2px #60a5fa, 0 0 0 4px #1f2937;
    }

    /* Navigation */
    .nav-menu {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .nav-item {
      display: flex;
      align-items: center;
      padding: 12px;
      border-radius: 8px;
      color: #d1d5db;
      text-decoration: none;
      transition: all 0.2s;
      cursor: pointer;
    }

    .nav-item:hover {
      background: #374151;
      color: white;
    }

    .nav-item.active {
      background: #2563eb;
      color: white;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }

    .nav-icon {
      width: 24px;
      height: 24px;
      margin-right: 16px;
    }

    /* Sidebar Footer */
    .sidebar-footer {
      margin-top: auto;
      padding-top: 16px;
      border-top: 1px solid #374151;
      text-align: center;
      font-size: 12px;
      color: #6b7280;
    }

    .sidebar-footer p {
      margin: 4px 0;
    }

    .sidebar-footer a {
      color: #60a5fa;
      text-decoration: none;
      transition: color 0.2s;
    }

    .sidebar-footer a:hover {
      color: #93c5fd;
      text-decoration: underline;
    }

    /* Main Content */
    .main-content {
      margin-left: 256px;
      flex: 1;
      padding: 24px 32px;
      overflow-y: auto;
    }

    /* Header */
    .page-header h1 {
      font-size: 30px;
      font-weight: 700;
      color: #111827;
      margin-bottom: 4px;
    }

    .page-header p {
      font-size: 14px;
      color: #6b7280;
      margin-bottom: 24px;
    }

    /* Stats Grid */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 24px;
      margin-bottom: 24px;
    }

    .stat-card {
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      gap: 16px;
      transition: transform 0.2s;
    }

    .stat-card:hover {
      transform: scale(1.05);
    }

    .stat-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      background: #dbeafe;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .stat-icon svg {
      width: 24px;
      height: 24px;
      color: #2563eb;
    }

    .stat-content h3 {
      font-size: 12px;
      font-weight: 500;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 4px;
    }

    .stat-content p {
      font-size: 24px;
      font-weight: 700;
      color: #111827;
    }

    .stat-content p.online {
      color: #10b981;
    }

    .stat-content p.offline {
      color: #ef4444;
    }

    /* Two Column Layout */
    .two-column {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-bottom: 24px;
    }

    .card {
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .card h2 {
      font-size: 18px;
      font-weight: 600;
      color: #111827;
      margin-bottom: 16px;
    }

    /* Test Input */
    textarea {
      width: 100%;
      height: 160px;
      padding: 12px;
      background: #f3f4f6;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 13px;
      resize: vertical;
      transition: all 0.2s;
    }

    textarea:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    /* Buttons */
    .button-group {
      display: flex;
      gap: 8px;
      margin-top: 16px;
    }

    .btn {
      flex: 1;
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn-primary {
      background: #2563eb;
      color: white;
    }

    .btn-primary:hover {
      background: #1d4ed8;
    }

    .btn-primary:disabled {
      background: #9ca3af;
      cursor: not-allowed;
    }

    .btn-secondary {
      background: #e5e7eb;
      color: #374151;
    }

    .btn-secondary:hover {
      background: #d1d5db;
    }

    /* Logs */
    .logs-container {
      height: 224px;
      background: #111827;
      border-radius: 8px;
      padding: 16px;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 12px;
      color: white;
      overflow-y: auto;
    }

    .log-entry {
      display: flex;
      margin-bottom: 4px;
    }

    .log-timestamp {
      color: #6b7280;
      margin-right: 8px;
    }

    .log-type {
      margin-right: 8px;
      font-weight: 600;
    }

    .log-type.info {
      color: #60a5fa;
    }

    .log-type.warning {
      color: #fbbf24;
    }

    .log-type.error {
      color: #f87171;
    }

    .log-message {
      color: #d1d5db;
      flex: 1;
    }

    /* Results Card */
    .results-card {
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      margin-bottom: 24px;
      display: none;
    }

    .results-card.show {
      display: block;
    }

    .result-section {
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 13px;
      padding: 16px;
      background: #f9fafb;
      border-radius: 8px;
      margin-bottom: 16px;
    }

    .result-section h4 {
      font-weight: 600;
      margin-bottom: 8px;
      color: #6b7280;
    }

    .result-section.anonymized h4 {
      color: #10b981;
    }

    .result-section.entities h4 {
      color: #2563eb;
    }

    .result-section p {
      white-space: pre-wrap;
      color: #111827;
    }

    .result-section ul {
      list-style: disc;
      margin-left: 20px;
      color: #111827;
    }

    /* Spinner */
    .spinner {
      width: 20px;
      height: 20px;
      border: 2px solid white;
      border-top-color: transparent;
      border-radius: 50%;
      animation: spin 0.6s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .two-column {
        grid-template-columns: 1fr;
      }

      .sidebar {
        width: 100%;
        height: auto;
        position: relative;
      }

      .main-content {
        margin-left: 0;
      }
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <aside class="sidebar">
    <!-- Logo -->
    <div class="logo-container">
      <svg class="logo-icon" viewBox="0 0 200 240" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="shieldGradient" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="#0f172a" />
            <stop offset="100%" stop-color="#020617" />
          </linearGradient>
          <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
            <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="#000000" flood-opacity="0.6" />
          </filter>
        </defs>
        <path d="M100 10 L170 50 V115 C170 150 140 195 100 220 C60 195 30 150 30 115 V50 Z" fill="url(#shieldGradient)" />
        <g filter="url(#shadow)">
          <path d="M50 95 Q70 75 100 80 Q130 75 150 95 Q140 112 150 130 Q125 125 100 128 Q75 125 50 130 Q60 112 50 95Z" fill="#0ea5e9" />
          <ellipse cx="78" cy="106" rx="14" ry="10" fill="#020617" />
          <ellipse cx="122" cy="106" rx="14" ry="10" fill="#020617" />
          <path d="M92 110 Q100 116 108 110" stroke="#020617" stroke-width="3" fill="none" />
        </g>
        <path d="M78 155 L94 173 L132 137" fill="none" stroke="#22c55e" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
      <div class="logo-text">
        <h1>Presidio</h1>
        <p>Anonymizer</p>
      </div>
    </div>

    <!-- Language Switcher -->
    <div class="lang-switcher">
      <svg class="lang-flag active" data-lang="pl" viewBox="0 0 5 3">
        <rect width="5" height="3" fill="#fff"/>
        <rect width="5" height="1.5" y="1.5" fill="#dc143c"/>
      </svg>
      <svg class="lang-flag" data-lang="en" viewBox="0 0 60 30">
        <clipPath id="a"><path d="M0 0v30h60V0z"/></clipPath>
        <path d="M0 0v30h60V0z" fill="#012169"/>
        <g clip-path="url(#a)">
          <path d="M0 0l60 30m0-30L0 30" stroke="#fff" stroke-width="6"/>
          <path d="M0 0l60 30m0-30L0 30" stroke="#c8102e" stroke-width="4"/>
          <path d="M30 0v30M0 15h60" stroke="#fff" stroke-width="10"/>
          <path d="M30 0v30M0 15h60" stroke="#c8102e" stroke-width="6"/>
        </g>
      </svg>
      <svg class="lang-flag" data-lang="de" viewBox="0 0 5 3">
        <rect width="5" height="3" y="0" fill="#000"/>
        <rect width="5" height="2" y="1" fill="#D00"/>
        <rect width="5" height="1" y="2" fill="#FFCE00"/>
      </svg>
    </div>

    <!-- Navigation -->
    <nav class="nav-menu">
      <a href="/dashboard" class="nav-item active">
        <svg class="nav-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 16v-2m-6-5H4m16 0h-2M7 11l-2 2 2 2m10-4l2 2-2 2m-5-9v2m0 10v2m-2-5h-2m6 0h-2" />
        </svg>
        <span class="nav-label">Dashboard</span>
      </a>
      <a href="/" class="nav-item">
        <svg class="nav-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
        </svg>
        <span class="nav-label">Ustawienia</span>
      </a>
    </nav>

    <!-- Footer -->
    <div class="sidebar-footer">
      <p>Wersja 1.0.1</p>
      <p>Stworzone przez<br><a href="https://bartoszgaca.pl" target="_blank">bartoszgaca.pl</a></p>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Header -->
    <div class="page-header">
      <h1 id="pageTitle">Dashboard</h1>
      <p id="pageSubtitle">Monitorowanie i testowanie usÅ‚ugi anonimizacji w czasie rzeczywistym.</p>
    </div>

    <!-- Stats Grid -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">
          <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01" />
          </svg>
        </div>
        <div class="stat-content">
          <h3 id="statStatusLabel">Status Serwisu</h3>
          <p id="statusValue" class="online">Online</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">
          <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 21h7a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v11m0 5l4.879-4.879m0 0a3 3 0 10-4.243-4.242 3 3 0 004.243 4.242z" />
          </svg>
        </div>
        <div class="stat-content">
          <h3 id="statRequestsLabel">Liczba Å»Ä…daÅ„</h3>
          <p id="requestCount">0</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">
          <svg class="logo-icon" viewBox="0 0 200 240" style="width:24px;height:24px">
            <path d="M100 10 L170 50 V115 C170 150 140 195 100 220 C60 195 30 150 30 115 V50 Z" fill="#2563eb" />
          </svg>
        </div>
        <div class="stat-content">
          <h3 id="statEntitiesLabel">Znalezione Encje</h3>
          <p id="entitiesFound">0</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">
          <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </div>
        <div class="stat-content">
          <h3 id="statAvgTimeLabel">Åšr. Czas Przetwarzania</h3>
          <p id="avgTime">0ms</p>
        </div>
      </div>
    </div>

    <!-- Two Column Grid -->
    <div class="two-column">
      <!-- Test Card -->
      <div class="card">
        <h2 id="testTitle">ðŸ§ª Test Anonimizacji</h2>
        <textarea id="testInput" placeholder="Wpisz tekst z danymi, np: CzeÅ›Ä‡, jestem Jan Kowalski, mÃ³j email to jan.kowalski@example.com a PESEL 92010212345."></textarea>
        <div class="button-group">
          <button class="btn btn-primary" id="testButton" onclick="testAnonymize()">
            <span id="testButtonText">ðŸš€ Testuj AnonimizacjÄ™</span>
          </button>
          <button class="btn btn-secondary" onclick="clearTest()">
            <svg style="width:20px;height:20px" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
            </svg>
          </button>
        </div>
      </div>

      <!-- Logs Card -->
      <div class="card">
        <h2 id="logsTitle">ðŸ“‹ Logi AktywnoÅ›ci</h2>
        <div class="logs-container" id="logsContainer">
          <div class="log-entry">
            <span class="log-timestamp">00:00:00</span>
            <span class="log-type info">[INFO]</span>
            <span class="log-message">Inicjalizacja dashboardu...</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Results Card -->
    <div class="results-card" id="resultsCard">
      <h2 id="resultsTitle">Wyniki Testu</h2>
      <div class="result-section">
        <h4 id="originalTextLabel">Oryginalny tekst:</h4>
        <p id="originalText"></p>
      </div>
      <div class="result-section anonymized">
        <h4 id="anonymizedTextLabel">Zanonimizowany tekst:</h4>
        <p id="anonymizedText"></p>
      </div>
      <div class="result-section entities">
        <h4 id="entitiesLabel">Wykryte Encje (<span id="entitiesCount">0</span>):</h4>
        <ul id="entitiesList"></ul>
      </div>
    </div>
  </main>

  <script>
    // Translations
    const translations = {
      pl: {
        pageTitle: 'Dashboard',
        pageSubtitle: 'Monitorowanie i testowanie usÅ‚ugi anonimizacji w czasie rzeczywistym.',
        statStatusLabel: 'Status Serwisu',
        statRequestsLabel: 'Liczba Å»Ä…daÅ„',
        statEntitiesLabel: 'Znalezione Encje',
        statAvgTimeLabel: 'Åšr. Czas Przetwarzania',
        testTitle: 'ðŸ§ª Test Anonimizacji',
        testPlaceholder: 'Wpisz tekst z danymi, np: CzeÅ›Ä‡, jestem Jan Kowalski, mÃ³j email to jan.kowalski@example.com a PESEL 92010212345.',
        testButton: 'ðŸš€ Testuj AnonimizacjÄ™',
        logsTitle: 'ðŸ“‹ Logi AktywnoÅ›ci',
        resultsTitle: 'Wyniki Testu',
        originalTextLabel: 'Oryginalny tekst:',
        anonymizedTextLabel: 'Zanonimizowany tekst:',
        entitiesLabel: 'Wykryte Encje',
        navDashboard: 'Dashboard',
        navSettings: 'Ustawienia',
        statusOnline: 'Online',
        statusOffline: 'Offline',
        logInit: 'Inicjalizacja dashboardu...'
      },
      en: {
        pageTitle: 'Dashboard',
        pageSubtitle: 'Real-time monitoring and testing of the anonymization service.',
        statStatusLabel: 'Service Status',
        statRequestsLabel: 'Total Requests',
        statEntitiesLabel: 'Entities Found',
        statAvgTimeLabel: 'Avg. Processing Time',
        testTitle: 'ðŸ§ª Anonymization Test',
        testPlaceholder: 'Enter text with PII, e.g., Hi, I am John Doe, my email is john.doe@example.com and my ID is 92010212345.',
        testButton: 'ðŸš€ Test Anonymization',
        logsTitle: 'ðŸ“‹ Activity Logs',
        resultsTitle: 'Test Results',
        originalTextLabel: 'Original text:',
        anonymizedTextLabel: 'Anonymized text:',
        entitiesLabel: 'Detected Entities',
        navDashboard: 'Dashboard',
        navSettings: 'Settings',
        statusOnline: 'Online',
        statusOffline: 'Offline',
        logInit: 'Initializing dashboard...'
      },
      de: {
        pageTitle: 'Dashboard',
        pageSubtitle: 'Echtzeit-Ãœberwachung und Testen des Anonymisierungsdienstes.',
        statStatusLabel: 'Dienststatus',
        statRequestsLabel: 'Anfragen gesamt',
        statEntitiesLabel: 'EntitÃ¤ten gefunden',
        statAvgTimeLabel: 'Ã˜ Bearbeitungszeit',
        testTitle: 'ðŸ§ª Anonymisierungstest',
        testPlaceholder: 'Geben Sie Text mit PII ein, z.B.: Hallo, ich bin Max Mustermann, meine E-Mail ist max.mustermann@example.com und meine ID ist 92010212345.',
        testButton: 'ðŸš€ Anonymisierung testen',
        logsTitle: 'ðŸ“‹ AktivitÃ¤tsprotokolle',
        resultsTitle: 'Testergebnisse',
        originalTextLabel: 'Originaltext:',
        anonymizedTextLabel: 'Anonymisierter Text:',
        entitiesLabel: 'Erkannte EntitÃ¤ten',
        navDashboard: 'Dashboard',
        navSettings: 'Einstellungen',
        statusOnline: 'Online',
        statusOffline: 'Offline',
        logInit: 'Initialisiere Dashboard...'
      }
    };

    let currentLang = 'pl';
    let stats = { requests: 0, entities: 0, totalTime: 0 };

    // Language switcher
    document.querySelectorAll('.lang-flag').forEach(flag => {
      flag.addEventListener('click', () => {
        document.querySelectorAll('.lang-flag').forEach(f => f.classList.remove('active'));
        flag.classList.add('active');
        currentLang = flag.dataset.lang;
        updateTranslations();
      });
    });

    function updateTranslations() {
      const t = translations[currentLang];
      document.getElementById('pageTitle').textContent = t.pageTitle;
      document.getElementById('pageSubtitle').textContent = t.pageSubtitle;
      document.getElementById('statStatusLabel').textContent = t.statStatusLabel;
      document.getElementById('statRequestsLabel').textContent = t.statRequestsLabel;
      document.getElementById('statEntitiesLabel').textContent = t.statEntitiesLabel;
      document.getElementById('statAvgTimeLabel').textContent = t.statAvgTimeLabel;
      document.getElementById('testTitle').textContent = t.testTitle;
      document.getElementById('testInput').placeholder = t.testPlaceholder;
      document.getElementById('testButtonText').textContent = t.testButton;
      document.getElementById('logsTitle').textContent = t.logsTitle;
      document.getElementById('resultsTitle').textContent = t.resultsTitle;
      document.getElementById('originalTextLabel').textContent = t.originalTextLabel;
      document.getElementById('anonymizedTextLabel').textContent = t.anonymizedTextLabel;
      document.getElementById('entitiesLabel').innerHTML = t.entitiesLabel + ' (<span id="entitiesCount">0</span>):';
      document.querySelectorAll('.nav-label')[0].textContent = t.navDashboard;
      document.querySelectorAll('.nav-label')[1].textContent = t.navSettings;
    }

    // Add log
    function addLog(message, type = 'info') {
      const container = document.getElementById('logsContainer');
      const timestamp = new Date().toLocaleTimeString();
      const entry = document.createElement('div');
      entry.className = 'log-entry';
      entry.innerHTML = `
        <span class="log-timestamp">${timestamp}</span>
        <span class="log-type ${type}">[${type.toUpperCase()}]</span>
        <span class="log-message">${message}</span>
      `;
      container.appendChild(entry);
      container.scrollTop = container.scrollHeight;
    }

    // Test anonymize
    async function testAnonymize() {
      const input = document.getElementById('testInput').value;
      if (!input.trim()) {
        alert(currentLang === 'pl' ? 'Wpisz jakiÅ› tekst!' : (currentLang === 'en' ? 'Enter some text!' : 'Geben Sie Text ein!'));
        return;
      }

      const button = document.getElementById('testButton');
      button.disabled = true;
      button.innerHTML = '<div class="spinner"></div>';

      addLog(currentLang === 'pl' ? 'RozpoczÄ™to test anonimizacji...' : (currentLang === 'en' ? 'Anonymization test started...' : 'Anonymisierungstest gestartet...'), 'info');

      try {
        const startTime = Date.now();
        const response = await fetch('/api/anonymize', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ text: input })
        });

        const data = await response.json();
        const duration = Date.now() - startTime;

        if (response.ok) {
          stats.requests++;
          stats.entities += data.stats.total_entities;
          stats.totalTime += duration;

          document.getElementById('requestCount').textContent = stats.requests;
          document.getElementById('entitiesFound').textContent = stats.entities;
          document.getElementById('avgTime').textContent = Math.round(stats.totalTime / stats.requests) + 'ms';

          document.getElementById('originalText').textContent = data.original_text;
          document.getElementById('anonymizedText').textContent = data.anonymized_text;
          document.getElementById('entitiesCount').textContent = data.stats.total_entities;

          const list = document.getElementById('entitiesList');
          list.innerHTML = data.entities_found.map(e =>
            `<li>${e.type}: "${e.text}" (pewnoÅ›Ä‡: ${(e.score * 100).toFixed(0)}%)</li>`
          ).join('');

          document.getElementById('resultsCard').classList.add('show');
          addLog(currentLang === 'pl' ? `Test zakoÅ„czony. Znaleziono ${data.stats.total_entities} encji w ${duration}ms.` : (currentLang === 'en' ? `Test finished. Found ${data.stats.total_entities} entities in ${duration}ms.` : `Test abgeschlossen. ${data.stats.total_entities} EntitÃ¤ten in ${duration}ms gefunden.`), 'info');
        } else {
          addLog(currentLang === 'pl' ? 'Test nie powiÃ³dÅ‚ siÄ™.' : (currentLang === 'en' ? 'Test failed.' : 'Test fehlgeschlagen.'), 'error');
        }
      } catch (error) {
        addLog(currentLang === 'pl' ? 'BÅ‚Ä…d poÅ‚Ä…czenia z API.' : (currentLang === 'en' ? 'API connection error.' : 'API-Verbindungsfehler.'), 'error');
      } finally {
        button.disabled = false;
        button.innerHTML = '<span id="testButtonText">' + translations[currentLang].testButton + '</span>';
      }
    }

    // Clear test
    function clearTest() {
      document.getElementById('testInput').value = '';
      document.getElementById('resultsCard').classList.remove('show');
      addLog(currentLang === 'pl' ? 'Test wyczyszczony.' : (currentLang === 'en' ? 'Test cleared.' : 'Test geleert.'), 'info');
    }

    // Check health
    async function checkHealth() {
      try {
        const response = await fetch('/api/health');
        const data = await response.json();
        const statusEl = document.getElementById('statusValue');
        if (data.status === 'healthy') {
          statusEl.textContent = translations[currentLang].statusOnline;
          statusEl.className = 'online';
        } else {
          statusEl.textContent = translations[currentLang].statusOffline;
          statusEl.className = 'offline';
        }
      } catch (error) {
        document.getElementById('statusValue').textContent = translations[currentLang].statusOffline;
        document.getElementById('statusValue').className = 'offline';
      }
    }

    // Initialize
    checkHealth();
    setInterval(checkHealth, 15000);
  </script>
</body>
</html>
